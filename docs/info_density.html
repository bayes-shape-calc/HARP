<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HARP Documentation - Density maps</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<link rel="stylesheet" href="styles_doc.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Density maps</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/HARP_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Hierarchical Atomic Resolution Perception</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://www.biorxiv.org" title="HARP paper" class="sidebar-tool px-1"><i class="bi bi-file-earmark-text"></i></a>
    <a href="https://github.com/bayes-shape-calc/HARP" title="HARP repo" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://bayes-shape-calc.github.io/" title="Shape-calc website" class="sidebar-tool px-1"><i class="bi bi-hexagon"></i></a>
    <a href="https://github.com/bayes-shape-calc" title="Shape calculations" class="sidebar-tool px-1"><i class="bi bi-upload"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Get Started</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./install.html" class="sidebar-item-text sidebar-link">Installing HARP</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials.html" class="sidebar-item-text sidebar-link">Tutorials</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Programs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./harpcalc.html" class="sidebar-item-text sidebar-link">harpcalc</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./openrcsb.html" class="sidebar-item-text sidebar-link">openrcsb</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Code Examples</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example1.html" class="sidebar-item-text sidebar-link">Load Data</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">API Documentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./info_bms.html" class="sidebar-item-text sidebar-link">Bayesian Model Selection</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./info_molecule.html" class="sidebar-item-text sidebar-link">Molecules</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./info_density.html" class="sidebar-item-text sidebar-link active">Density maps</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#gridclass" id="toc-gridclass" class="nav-link active" data-scroll-target="#gridclass">gridclass</a></li>
  <li><a href="#load" id="toc-load" class="nav-link" data-scroll-target="#load">load</a></li>
  <li><a href="#x2i" id="toc-x2i" class="nav-link" data-scroll-target="#x2i">x2i</a></li>
  <li><a href="#i2x" id="toc-i2x" class="nav-link" data-scroll-target="#i2x">i2x</a></li>
  <li><a href="#subgrid_center" id="toc-subgrid_center" class="nav-link" data-scroll-target="#subgrid_center">subgrid_center</a></li>
  <li><a href="#subgrid_extract" id="toc-subgrid_extract" class="nav-link" data-scroll-target="#subgrid_extract">subgrid_extract</a></li>
  <li><a href="#trim_density_to_mol" id="toc-trim_density_to_mol" class="nav-link" data-scroll-target="#trim_density_to_mol">trim_density_to_mol</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Density maps</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The experimental density map for a cryoEM experiment itself corresponds to a 3-D <code>numpy.ndarray</code> that contains the value of the density at different voxels. It is the location of the voxels themselves that encodes how these density values map onto the spatial information of the biomolecule. This information on the grid of the density map is stored in a separate class (<code>gridclass</code>) in HARP.</p>
<section id="gridclass" class="level2">
<h2 class="anchored" data-anchor-id="gridclass">gridclass</h2>
<pre><code>class harp.density.gridclass (origin, dxyz, nxyz, *args, **kwargs)</code></pre>
<p>A <code>gridclass</code> object stores the grid defining the voxel locations for a density map.</p>
<section id="attributes" class="level4">
<h4 class="anchored" data-anchor-id="attributes">Attributes</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>self.origin</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> A 1-D <code>double</code> array of size 3 containing the Cartesian coordinates of the lower corner of the grid.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>self.dxyz</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> A 1-D <code>double</code> array of size 3 containing the rectilinear spacing between each grid point along all Cartesian axes.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>self.nxyz</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> A 1-D <code>double</code> array of size 3 containing the number of grid points in each Cartesian direction</td>
</tr>
</tbody>
</table>
</section>
<section id="functions" class="level4">
<h4 class="anchored" data-anchor-id="functions">Functions</h4>
<p>The functions associated with <code>gridclass</code> are</p>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>self.xyzmin</code></td>
<td style="text-align: left;">Returns the Cartesian coordinates of the lower corner of the grid (<em>i.e.</em>, <code>self.origin</code>). <br> <strong>Input:</strong> None. <br> <strong>Output</strong> A <code>numpy.ndarray</code> of <code>double</code> values, of size 3.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>self.xyzmax</code></td>
<td style="text-align: left;">Returns the Cartesian coordinates of the upper corner of the grid (<em>i.e.</em>, the one diagonally opposite <code>self.origin</code>). <br> <strong>Input:</strong> None. <br> <strong>Output</strong> A <code>numpy.ndarray</code> of <code>double</code> values, of size 3.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>self.com</code></td>
<td style="text-align: left;">Returns the Cartesian coordinates of the center-of-mass of the grid (not weighted by the density). <br> <strong>Input:</strong> None. <br> <strong>Output</strong> A <code>numpy.ndarray</code> of <code>double</code> values, of size 3.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>self.grid_ijk()</code></td>
<td style="text-align: left;">Returns an array of the indices of the grid. <br> <strong>Input:</strong> None. <br> <strong>Output:</strong> A <code>tuple</code> of <code>gx</code>, <code>gy</code>, and <code>gy</code>, which are 1-D <code>numpy.ndarray</code>s of <code>int</code> values, of size <code>self.nxyz[0]</code>, <code>self.nxyz[1]</code> and <code>self.nxyz[2]</code>, which are the number of gridpoints in the x-, y- and z-direction respectively.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>self.grid_xyz</code></td>
<td style="text-align: left;">Returns an array of the Cartesian coordinates corresponding to the indices of the grid. <br> <strong>Input:</strong> None. <br> <strong>Output:</strong> A <code>tuple</code> of <code>gx</code>, <code>gy</code>, and <code>gy</code>, which are 1-D <code>numpy.ndarray</code>s of <code>double</code> values, of size <code>self.nxyz[0]</code>, <code>self.nxyz[1]</code> and <code>self.nxyz[2]</code>, which are the number of gridpoints in the x-, y- and z-direction respectively.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="load" class="level2">
<h2 class="anchored" data-anchor-id="load">load</h2>
<pre><code>harp.density.load (fname)</code></pre>
<p>This function loads cryoEM densities and the associated grid (file format suffixes supported are .map, .MAP, .mrc, .MRC, .map.gz, and .MAP.gz).</p>
<section id="arguments" class="level4">
<h4 class="anchored" data-anchor-id="arguments">Arguments</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>fname</code></td>
<td style="text-align: left;"><code>string</code> <br> The file-name for the cryoEM density map.</td>
</tr>
</tbody>
</table>
</section>
<section id="output" class="level4">
<h4 class="anchored" data-anchor-id="output">Output</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The grid of voxel locations of the cryoEM density map.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>density</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> A 3-D array of <code>double</code> values corresponding to the density values at specific voxels corresponding to <code>grid</code>.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="x2i" class="level2">
<h2 class="anchored" data-anchor-id="x2i">x2i</h2>
<pre><code>harp.density.x2i (grid, point)</code></pre>
<p>This function transforms a point in Cartesian coordinates to the grid indices based on a particular grid.</p>
<section id="arguments-1" class="level4">
<h4 class="anchored" data-anchor-id="arguments-1">Arguments</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The cryoEM grid which the Cartesian coordinates will be transformed with respect to.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>point</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> An array of <code>double</code> values of size 3, containing the Cartesian coordinates of the point.</td>
</tr>
</tbody>
</table>
</section>
<section id="output-1" class="level4">
<h4 class="anchored" data-anchor-id="output-1">Output</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>point</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> An array of <code>int</code> values of size 3, containing the grid indices of the point.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="i2x" class="level2">
<h2 class="anchored" data-anchor-id="i2x">i2x</h2>
<pre><code>harp.density.i2x (grid, point)</code></pre>
<p>This function transforms a point in grid indices to Cartesian coordinates based on a particular grid.</p>
<section id="arguments-2" class="level4">
<h4 class="anchored" data-anchor-id="arguments-2">Arguments</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The cryoEM grid which the grid indices will be transformed with respect to.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>point</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> An array of <code>int</code> values of size 3, containing the grid indices of the point.</td>
</tr>
</tbody>
</table>
</section>
<section id="output-2" class="level4">
<h4 class="anchored" data-anchor-id="output-2">Output</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>point</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> An array of <code>double</code> values of size 3, containing the Cartesian coordinates of the point.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="subgrid_center" class="level2">
<h2 class="anchored" data-anchor-id="subgrid_center">subgrid_center</h2>
<pre><code>harp.density.subgrid_center (grid, centerxyz, halfwidthxyz)</code></pre>
<p>This function defines and returns a cubic subgrid within a specific <code>gridclass</code> object centered at the specified point and with a specified half-width in every direction from that point.</p>
<section id="arguments-3" class="level4">
<h4 class="anchored" data-anchor-id="arguments-3">Arguments</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The cryoEM grid in which the subgrid will be defined</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>centerxyz</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> An array of <code>double</code> values of size 3, containing the Cartesian coordinates of the center of the subgrid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>halfwidthxyz</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> An array of <code>double</code> values of size 3, containing the halfwidths of the subgrid from the center (in <span class="math inline">\(\unicode{x212B}\)</span>).</td>
</tr>
</tbody>
</table>
</section>
<section id="output-3" class="level4">
<h4 class="anchored" data-anchor-id="output-3">Output</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;">A <code>gridclass</code> object containing the defined subgrid.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="subgrid_extract" class="level2">
<h2 class="anchored" data-anchor-id="subgrid_extract">subgrid_extract</h2>
<pre><code>harp.density.subgrid_extract (grid, data, subgrid)</code></pre>
<p>This function extracts the cryoEM density from a map for the voxels corresponding to a cubic subgrid within a specific grid.</p>
<section id="arguments-4" class="level4">
<h4 class="anchored" data-anchor-id="arguments-4">Arguments</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The cryoEM grid associated with the cryoEM map.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> The cryoEM density values defined at the voxel locations in <code>grid</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>subgrid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The subgrid defined on <code>grid</code> for which the densities will be extracted.</td>
</tr>
</tbody>
</table>
</section>
<section id="output-4" class="level4">
<h4 class="anchored" data-anchor-id="output-4">Output</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> The cryoEM density values defined at the voxel locations in <code>subgrid</code>.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="trim_density_to_mol" class="level2">
<h2 class="anchored" data-anchor-id="trim_density_to_mol">trim_density_to_mol</h2>
<pre><code>harp.density.trim_density_to_mol (grid, data, mol, pad = 8.)</code></pre>
<p>This function finds the box that emcompasses the atomic coordinates of a specific molecular model on the grid for a specified density map and returns a trimmed grid and associated density map corresponding to this box. The trimmed box may additionally be padded isotropically by a constant value using periodic boundary condtions. This truncation is particularly useful for maps where only a small region has been used to build a model (which commonly occurs for molecules with high rotational symmetry) as it greatly reduces the computational cost of HARP calculations in these cases.</p>
<section id="arguments-5" class="level4">
<h4 class="anchored" data-anchor-id="arguments-5">Arguments</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The cryoEM grid associated with the cryoEM map.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> The cryoEM density values defined at the voxel locations in <code>grid</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mol</code></td>
<td style="text-align: left;"><code>harp.molecule.atomcollection</code> <br> The molecular model that is built using part of the the cryoEM densities in <code>data</code> at voxel locations specified in <code>grid</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pad</code></td>
<td style="text-align: left;"><code>double</code> <br> A constant length (in <span class="math inline">\(\unicode{x212B}\)</span>) that is added to the box encompassing <code>mol</code> that is padded using peridic boundary conditions. The default value is 8.</td>
</tr>
</tbody>
</table>
</section>
<section id="output-5" class="level4">
<h4 class="anchored" data-anchor-id="output-5">Output</h4>
<table class="table">
<colgroup>
<col style="width: 40%">
<col style="width: 60%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Descrption</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>grid</code></td>
<td style="text-align: left;"><code>gridclass</code> <br> The grid trimmed to the box around <code>mol</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>data</code></td>
<td style="text-align: left;"><code>numpy.ndarray</code> <br> The cryoEM densities at the voxel locations specified by the trimmed <code>grid</code>.</td>
</tr>
</tbody>
</table>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>